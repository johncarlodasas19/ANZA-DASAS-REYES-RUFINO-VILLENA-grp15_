{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Dashboard</h3>
  <form class="d-flex" method="get" action="{{ url_for('dashboard') }}"><input class="form-control me-2" name="q" placeholder="Search" value="{{ q }}"><button class="btn btn-outline-secondary">Search</button></form>
</div>
<div class="row">
  <div class="col-md-8">
    <div class="row row-cols-1 row-cols-md-2 g-3">
      {% for it in items %}
      <div class="col">
        <div class="card h-100">
          {% if it.photo %}<img src="{{ url_for('static', filename='uploads/' ~ it.photo) }}" class="card-img-top">{% else %}<img src="{{ url_for('static', filename='uploads/placeholder.jpg') }}" class="card-img-top">{% endif %}
          <div class="card-body">
            <h5 class="card-title">{{ it.type|capitalize }}: {{ it.name }}</h5>
            <p class="card-text text-truncate">{{ it.description }}</p>
            <p><span class="badge bg-info">{{ it.status }}</span> <small class="text-muted">at {{ it.location }}</small></p>
            <a href="{{ url_for('view_item', item_id=it.id) }}" class="btn btn-sm btn-primary">View</a>
            {% if current_user.id == it.user_id or current_user.is_admin %}
              <a href="{{ url_for('edit_item', item_id=it.id) }}" class="btn btn-sm btn-secondary">Edit</a>
              <form method="post" action="{{ url_for('delete_item', item_id=it.id) }}" class="d-inline"><button class="btn btn-sm btn-danger">Delete</button></form>
            {% endif %}
          </div>
        </div>
      </div>
      {% else %}<div class="col"><div class="alert alert-info">No items yet.</div></div>{% endfor %}
    </div>
  </div>
  <div class="col-md-4">
    <div class="card mb-3 shadow-sm"><div class="card-body">
      <h5 class="card-title">Quick Actions</h5>
      <a href="{{ url_for('new_item') }}" class="btn btn-success w-100 mb-2">Report Lost/Found</a>
    </div></div>
    <div class="card shadow-sm"><div class="card-body">
      <h6 class="card-title">Your info</h6>
      <p>{{ current_user.name }}<br><small>{{ current_user.email }}</small></p>
      {% if current_user.is_admin %}<span class="badge bg-warning text-dark">Admin</span>{% endif %}
    </div></div>
  </div>
</div>
{% endblock %}
